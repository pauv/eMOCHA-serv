<?xml version="1.0"?>
<h:html xmlns="http://www.w3.org/2002/xforms" 
				xmlns:h="http://www.w3.org/1999/xhtml" 
				xmlns:ev="http://www.w3.org/2001/xml-events" 
				xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
				xmlns:jr="http://openrosa.org/javarosa">
	<h:head>
		<h:title>HIV Positive follow up</h:title>
		
		<model>			
			<itext>
			  <translation lang="English">
			    <text id="scheduled_fu_visit_date">
			      <value>Skip if no visit scheduled</value>
			    </text>
			    <text id="when_ready">
			      <value>When ready, slide to the next screen</value>
			    </text>
			  </translation>
			</itext>
			<instance>
				<data>
			        <meta>
						<form_name>HIV Pos FU</form_name>
						<form_version>0.0.3</form_version>
						<start/>
						<end/>
						<today/>
						<device_id/>
						<subscriber_id/>
						<sim_id/>
					</meta>
					
					<did_visit_clinic />
					<visit_clinic_challenges />
					<discussed_CD4 />
					<received_CD4 />
					<CD4_count />
					<received_BCP />
					<taking_Sep_Cxz />
					<taking_ARV />
					<taken_ARV_30d />
					<visited_support />
					<reason_not_visited />
					<will_visit_clinic />
					<discuss_CD4 />
					<provided_fu_counseling />
					<scheduled_fu_visit_done />
					<scheduled_fu_visit_date />

					<!-- Social Harm questions-->
					<patient_abused />	
					<abuse_group />
					<abuse_description>
						<by_whom />
						<verbally_abused />
						<physically_abused />
						<consequences />
						<consequences_description />
						<concise_description />
					</abuse_description>
					<!-- END Social Harm questions-->

					<emocha_data>
						<phone_id />										
						<village_code />
						<household_code />
						<patient_code />										
						<referral_done />										
					</emocha_data>
				</data>
			</instance>

			<bind nodeset="/data/meta/start" type="dateTime" jr:preload="timestamp" jr:preloadParams="start"/>
			<bind nodeset="/data/meta/end" type="dateTime" jr:preload="timestamp" jr:preloadParams="end"/>
			<bind nodeset="/data/meta/today" type="date" jr:preload="date" jr:preloadParams="today"/>
			<bind nodeset="/data/meta/device_id" type="string" jr:preload="property" jr:preloadParams="deviceid"/>
			<bind nodeset="/data/meta/subscriber_id" type="string" jr:preload="property" jr:preloadParams="subscriberid"/>
			<bind nodeset="/data/meta/sim_id" type="string" jr:preload="property" jr:preloadParams="simserial"/>
			
			<!-- Questions -->
			<bind nodeset="/data/did_visit_clinic" required="true()" type="string" />
			<bind nodeset="/data/visit_clinic_challenges" required="true()" type="string" 
				relevant="/data/did_visit_clinic = '1'" 
				constraint="count-selected(.) &lt;= 1 or not(selected(., '77') or selected(., '99'))" 
				jr:constraintMsg="only 1 option can be set when declined or doesn't know" />
			<bind nodeset="/data/discussed_CD4" required="true()" type="string" 
				relevant="/data/did_visit_clinic = '1'" />
			<bind nodeset="/data/received_CD4" required="true()" type="string" 
				relevant="/data/did_visit_clinic = '1'" />
			<bind nodeset="/data/CD4_count" required="true()" type="int" 
				constraint=". &lt; 10000" 
				jr:constraintMsg="value too high" 
				relevant="/data/did_visit_clinic = '1' and /data/received_CD4 = '1'" />
			<bind nodeset="/data/received_BCP" required="true()" type="string" 
				relevant="/data/did_visit_clinic = '1'" />
			<bind nodeset="/data/taking_Sep_Cxz" required="true()" type="string" 
				relevant="/data/did_visit_clinic = '1'" />
			<bind nodeset="/data/taking_ARV" required="true()" type="string" 
				relevant="/data/did_visit_clinic = '1'" />
			<bind nodeset="/data/taken_ARV_30d" required="true()" type="string" 
				relevant="/data/did_visit_clinic = '1' and /data/taking_ARV = '1'" />
			<bind nodeset="/data/visited_support" required="true()" type="string" 
				relevant="/data/did_visit_clinic = '1'" />
			
			<bind nodeset="/data/reason_not_visited" required="true()" type="string" 
				relevant="/data/did_visit_clinic != '1'" />
			<bind nodeset="/data/will_visit_clinic" required="true()" type="string" 
				relevant="/data/did_visit_clinic != '1'" />
			<bind nodeset="/data/discuss_CD4" required="false()" readonly="true()" type="string" 
				relevant="/data/did_visit_clinic != '1'" />
			<bind nodeset="/data/provided_fu_counseling" required="true()" type="string" 
				relevant="/data/did_visit_clinic != '1'" />
			<bind nodeset="/data/scheduled_fu_visit_date" required="false()" type="date" 
				constraint=". &gt;= today()" 
				jr:constraintMsg="only future dates allowed" 
				relevant="/data/did_visit_clinic != '1'" />
			<bind nodeset="/data/scheduled_fu_visit_done" type="string" 
				calculate="if(/data/scheduled_fu_visit_date &gt; today(), '1', '0')" 
				relevant="/data/did_visit_clinic != '1'" />
					
			<!-- Social Harm Questions -->
			<bind nodeset="/data/patient_abused" type="string" />
			<bind nodeset="/data/abuse_group" relevant="/data/patient_abused = '1'" />
			<bind nodeset="/data/abuse_description/by_whom" type="string" />
			<bind nodeset="/data/abuse_description/verbally_abused" type="string" />
			<bind nodeset="/data/abuse_description/physically_abused" type="string" />
			<bind nodeset="/data/abuse_description/consequences" type="string" />
			<bind nodeset="/data/abuse_description/consequences_description" type="string" relevant="/data/abuse_description/consequences = '6' "/>
			<bind nodeset="/data/abuse_description/concise_description" type="string" />
			<!-- END Social Harm Questions -->

			<!-- emocha related data -->
			<bind nodeset="/data/emocha_data/phone_id" type="int" calculate="-1" />
			<bind nodeset="/data/emocha_data/village_code" type="int" calculate="-1" />
			<bind nodeset="/data/emocha_data/household_code" type="string" calculate="-1" />
			<bind nodeset="/data/emocha_data/patient_code" type="string" calculate="-1" />
			<bind nodeset="/data/emocha_data/referral_done" type="int" calculate="0" />
			<!-- end emocha data-->
		</model>
	</h:head>
	<h:body>
		
		<select1 ref="did_visit_clinic">
			<label>Since the last time I saw you, did you visit the HIV care clinic?</label>
			<item><value>0</value><label>No</label></item>
			<item><value>1</value><label>Yes</label></item>
			<item><value>77</value><label>Don't know</label></item>
			<item><value>99</value><label>Declined to answer</label></item>
		</select1>

		<select ref="visit_clinic_challenges">
			<label>What, if any challenges did you experience when you went to the clinic?</label>
			<item><value>1</value><label>Long wait times</label></item>
			<item><value>2</value><label>Transport was expensive</label></item>
			<item><value>3</value><label>Staff didn't treat me with respect</label></item>
			<item><value>4</value><label>I was worried about being seen there</label></item>
			<item><value>5</value><label>I didn't experience any challenges</label></item>
			<item><value>6</value><label>Other</label></item>
			<item><value>77</value><label>Don't know</label></item>
			<item><value>99</value><label>Declined to answer</label></item>
		</select>

		<select1 ref="discussed_CD4">
			<label>Discuss CD4 results from initial visit, if not already done</label>
			<item><value>0</value><label>Not done</label></item>
			<item><value>1</value><label>Done</label></item>
		</select1>

		<select1 ref="received_CD4">
			<label>Did you receive the results of your CD4 count from clinic?</label>
			<item><value>0</value><label>No</label></item>
			<item><value>1</value><label>Yes</label></item>
			<item><value>77</value><label>Don't know</label></item>
			<item><value>99</value><label>Declined to answer</label>></item>
		</select1>

		<input ref="CD4_count">
			<label>What were the results of your CD4 count?</label>	
		</input>

		<select1 ref="received_BCP">
			<label>Did you receive the Basic Care Package (BCP?)</label>	
			<item><value>0</value><label>No</label></item>
			<item><value>1</value><label>Yes</label></item>
			<item><value>77</value><label>Don't know</label></item>
			<item><value>99</value><label>Declined to answer</label></item>
		</select1>

		<select1 ref="taking_Sep_Cxz">
			<label>Are you taking Septrin or Cotrimoxazole?</label>	
			<item><value>0</value><label>No</label></item>
			<item><value>1</value><label>Yes</label></item>
			<item><value>77</value><label>Don't know</label></item>
			<item><value>99</value><label>Declined to answer</label></item>
		</select1>

		<select1 ref="taking_ARV">
			<label>Are you taking ARV (antiretroviral medication)?</label>	
			<item><value>0</value><label>No</label></item>
			<item><value>1</value><label>Yes</label></item>
			<item><value>77</value><label>Don't know</label></item>
			<item><value>99</value><label>Declined to answer</label></item>
		</select1>

		<select1 ref="taken_ARV_30d">
			<label>In the last 30 days, how much of your prescribed ARV medication have you taken?</label>
			<item><value>1</value><label>All of it</label></item>
			<item><value>2</value><label>Most of it</label></item>
			<item><value>3</value><label>Some of it</label></item>
			<item><value>4</value><label>None of it</label></item>
			<item><value>77</value><label>Don't know</label></item>
			<item><value>99</value><label>Declined to answer</label></item>
		</select1>

		<select1 ref="visited_support">
			<label>Did you visit any of the resources for support we discussed last time? (e.g. support groups, counseling, etc.)</label>
			<item><value>0</value><label>No</label></item>
			<item><value>1</value><label>Yes</label></item>
			<item><value>77</value><label>Don't know</label></item>
			<item><value>99</value><label>Declined to answer</label></item>
		</select1>

		<select1 ref="reason_not_visited">
			<label>What is the main reason you did not visit a care clinic?</label>
			<item><value>1</value><label>Too busy</label></item>
			<item><value>2</value><label>Didn't know where to go</label></item>
			<item><value>3</value><label>Not enough money for transport</label></item>
			<item><value>4</value><label>Staff won't treat me with respect</label></item>
			<item><value>5</value><label>I didn't want anyone to see me</label></item>
			<item><value>6</value><label>Other</label></item>
			<item><value>77</value><label>Don't know</label></item>
			<item><value>99</value><label>Declined to answer</label></item>
		</select1>

		<select1 ref="will_visit_clinic">
			<label>Do you plan on visiting an HIV care clinic in the future?</label>
			<item><value>0</value><label>Don't see a need</label></item>
			<item><value>1</value><label>Might be good, but I'm not ready to do it</label></item>
			<item><value>2</value><label>I plan to do it</label></item>
			<item><value>3</value><label>Don't know</label></item>
			<item><value>99</value><label>Declined to answer</label></item>
		</select1>

		<input ref="discuss_CD4">
			<label>Discuss CD4 results from initial visit, if done and not already discussed</label>
			<hint ref="jr:itext('when_ready')"></hint>
		</input>

		<select1 ref="provided_fu_counseling">
			<label>Provide counseling on importance of care and schedule follow-up visit</label>
			<item><value>0</value><label>Not done</label></item>
			<item><value>1</value><label>Done</label></item>
		</select1>

		<input ref="scheduled_fu_visit_date">
			<label>Schedule follow up visit</label>
			<hint ref="jr:itext('scheduled_fu_visit_date')"></hint>
		</input>

		<!-- Social Harm Questions -->	
		<select1 ref="/data/patient_abused">
			<label>Since we last saw you, have you been verbally and/or physically abused as a result of learning your HIV results?</label>
			<item><value>0</value><label>No</label></item>
			<item><value>1</value><label>Yes</label></item>
		</select1>

		<group ref="/data/abuse_group">
			<!-- Q2 -->
			<input ref="/data/abuse_description/by_whom">
				<label>By whom were you abused?</label>
			</input>

			<!-- Q3 -->
			<select1 ref="/data/abuse_description/verbally_abused">
				<label>Were you verbally abused by this person?</label>
				<item><value>0</value><label>No</label></item>
				<item><value>1</value><label>Yes</label></item>
			</select1>

			<!-- Q4 -->
			<select1 ref="/data/abuse_description/physically_abused">
				<label>Were you physically abused by this person?</label>
				<item><value>0</value><label>No</label></item>
				<item><value>1</value><label>Yes</label></item>
			</select1>

			<!-- Q4 -->
			<select1 ref="/data/abuse_description/consequences">
				<label>What were the consequences of the abuse?</label>
				<item><value>0</value><label>None</label></item>
				<item><value>1</value><label>Relationship break up</label></item>
				<item><value>2</value><label>Loss of income or economic support</label></item>
				<item><value>3</value><label>Loss of employment</label></item>
				<item><value>4</value><label>Change of residence</label></item>
				<item><value>5</value><label>Loss of custody of children</label></item>
				<item><value>6</value><label>Other (specify)</label></item>
			</select1>

			<!-- Q4.1 -->
			<input type="text" ref="/data/abuse_description/consequences_description">
				<label>Please specify the consequences</label>
			</input>

			<!-- Q5 -->
			<input type="text" ref="/data/abuse_description/concise_description">
				<label>Concisely describe the social harm</label>
			</input>
		</group>
		<!-- END Social Harm Questions -->	
	</h:body>
</h:html>
